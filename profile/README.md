# E2BS.Shop
- E2BS는 다양한 카테고리의 책을 조회하고 구매할 수 있는 사이트입니다.
- URL: https://www.e2bs.shop

### 개발 기간
- 2025-04-28 ~ 2025-06-13

### 구성원
| <a href="https://github.com/Doyun-coding"><img src="https://avatars.githubusercontent.com/u/90900630?v=4" width="100px"><br>김도윤</a> | <a href="https://github.com/K-Y-k"><img src="https://avatars.githubusercontent.com/u/102020649?v=4" width="100px"><br>김용경</a> | <a href="https://github.com/KimHyunKyu1"><img src="https://avatars.githubusercontent.com/u/160554277?v=4" width="100px"><br>김현규</a> |<a href="https://github.com/asdasd7722"><img src="https://avatars.githubusercontent.com/u/107762636?v=4" width="100px"><br>박상준</a> |<a href ="https://github.com/sooooooing"> <img src ="https://avatars.githubusercontent.com/u/126747506?v=4" width ="100px"><br>박수인</a> | <a href ="https://github.com/0u0-chae"> <img src ="https://avatars.githubusercontent.com/u/130735493?v=4" width ="100px"><br>이영채</a> | <a href ="https://github.com/JS01C"> <img src ="https://avatars.githubusercontent.com/u/174989512?v=4" width ="100px"><br>최종성</a>
|-----|-----|-----|-----|-----|-----|-----|

### 개발 환경
- 개발도구: Intellij IDEA - Ultimate
- 언어: Java 21 Temurin
- 빌드도구: Maven
- 개발
  - Spring Framework: 6.1
  - Spring Boot: 3.4.5
  - Spring Cloud
    - Spring Cloud Gateway
    - Spring Cloud Netflex(Eureka)
    - Spring Cloud Config
  - Spring Data
    - Spring Data JPA
    - Spring Data Elasticsearch
    - Spring Data Redis
- 테스트
  - Junit5
  - AssertJ
  - Mockito
  - SonarQube
- 데이터베이스
  - MySQL
  - Redis
- 검색엔진
  - Elastic Search
- ERD
  - ERDCloud
- UI
  - BOOTSTRAP5
- Object Storage
  - Minio
- Message Queue
  - RabbitMQ


### 언어
![Java](https://img.shields.io/badge/Java-E34F26?style=for-the-badge&logo=Java&logoColor=white)

### Framework
![Spring](https://img.shields.io/badge/spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white)
![Spring Boot](https://img.shields.io/badge/spring%20boot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white)
![SpringDataJPA](https://img.shields.io/badge/Spring%20Data%20JPA-6DB33F?style=for-the-badge&logo=Spring&logoColor=white)
</br>
![Spring Cloud Gateway](https://img.shields.io/badge/Spring_Cloud_Gateway-6DB33F.svg?style=for-the-badge&logo=spring&logoColor=white)
![Spring Eureka](https://img.shields.io/badge/Spring_Eureka-6DB33F.svg?style=for-the-badge&logo=spring&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-black?style=for-the-badge&logo=JSON%20web%20tokens)
![Hibernate](https://img.shields.io/badge/Hibernate-59666C.svg?style=for-the-badge&logo=hibernate&logoColor=white)

### Build Tool
![Apache Maven](https://img.shields.io/badge/Apache%20Maven-C71A36?style=for-the-badge&logo=Apache%20Maven&logoColor=white)

### DataBase
![MySQL](http://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=MySQL&logoColor=white)
![Redis](https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=Redis&logoColor=white)

### CI/CD
![Github Action](https://img.shields.io/badge/Github%20Action-2088FF?style=for-the-badge&logo=githubactions&logoColor=white)

### DevOps
![NHN Cloud](https://img.shields.io/badge/-NHN%20Cloud-blue?style=for-the-badge&logo=iCloud&logoColor=white)
![SonarQube](https://img.shields.io/badge/SonarQube-4E98CD?style=for-the-badge&logo=SonarQube&logoColor=white)

### ETC
![Git](https://img.shields.io/badge/Git-F05032?style=for-the-badge&logo=Git&logoColor=white)
![GitHub](https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=GitHub&logoColor=white)
![Junit5](https://img.shields.io/badge/Junit5-25A162?style=for-the-badge&logo=Junit5&logoColor=white)
![IntelliJ IDEA](https://img.shields.io/badge/IntelliJ_IDEA-000000.svg?style=for-the-badge&logo=intellij-idea&logoColor=white)
</br>
![Elasticsearch](https://img.shields.io/badge/Elasticsearch-005571.svg?style=for-the-badge&logo=elasticsearch&logoColor=white)
![Linux](https://img.shields.io/badge/Linux-FCC624?style=for-the-badge&logo=linux&logoColor=black) 
![Ubuntu](https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white)

### Front
![Thymeleaf](https://img.shields.io/badge/Thymeleaf-005F0F.svg?style=for-the-badge&logo=thymeleaf&logoColor=white)
![Bootstrap5](https://img.shields.io/badge/Bootstrap5-7952B3.svg?style=for-the-badge&logo=bootstrap&logoColor=white)
![JavaScript](https://img.shields.io/badge/JavaScript-F7DF1E.svg?style=for-the-badge&logo=javascript&logoColor=black)


## 아키텍쳐 구조
![architect](https://github.com/user-attachments/assets/3de6a5c8-a4fc-4022-b3ea-df2250d1f054)
<br>

## CI/CD
![cicd](https://github.com/user-attachments/assets/8bf00665-14d9-4177-9ff9-2b499cd3d2fa)
<br>

### ERD
![erd](https://github.com/user-attachments/assets/35649ef1-e76b-4d05-b491-0c23d85df132)
<br>
  
## Project Management
> Github 제공하는 `Projects`를 활용하여 전반적인 프로젝트 관리

### Scrum
- 시간
  - 매일 09:10 Scrum Meeting 진행
- 회의 내용
  - 금일 Scrum Meeting까지 진행한 내용
  - 다음 Scrum Meeting까지 진행할 내용
  - 팀원들과 논의가 필요하다고 판단되는 사항
    
![scrum](https://github.com/user-attachments/assets/0ac52411-5da0-4797-a228-3c1f7039b2cb)


### 일정관리
- GitHub Roadmap을 활용하여 전체 일정 및 진행 상황을 시각적으로 관리
- WBS(Work Breakdown Structure)를 작성하여 요구사항을 세부 작업으로 분해하고, 이를 GitHub Issue로 등록하여 역할을 분담하고 일정 추적
  
![project](https://github.com/user-attachments/assets/4ae24748-95db-4842-9fd5-f9fb157bb878)

    
# 기능 
## 김도윤
![E2BS - JWT](https://github.com/user-attachments/assets/2975fc0f-2792-4c5f-9494-a0dd84e0f89b)

### 인프라
- GitHub Actions 기반 CI/CD 파이프라인 구축
- NGINX 리버스 프록시 설정
- 서버 RSA 암호화 키를 깃허브에 저장하여 SSH로 서버 접근 가능하도록 설정
- 배포 자동화를 위해 startup.sh 스크립트 내 로직을 구성하여 무중단 배포 서버 구현
- startup.sh 스크립트 내 로직을 통해 각 서버 빌드 로그들을 저장
- Cloudflare를 사용하여 https 적용
- CONFIG 서버 구현 및 CONFIG 서버를 위한 RSA 키를 생성하고, 이를 통해 GitHub 레포지토리에 접근할 수 있도록 설정을 구현
- DBCP2 설정 및 logback 설정을 통한 로그 관리
- 공통 ERROR 메세지를 properties에 저장하고 에러 처리를 위한 Controller 구현

### 로그인/회원가입
- Spring Security 및 PAYCO OAuth2를 이용한 로그인 기능 구현
- 회원가입 회원 생성 기능 구현
- 휴면 상태 회원 Dooray / Email 인증을 통한 휴면 상태 해제 구현

### 인증/인가
- 로그인 시 AUTH 서버로 이동하여 Access Token + Refresh Token 발급
- Access Token은 FRONT 서버 쿠키, Refresh Token은 redis에 저장
- BACK API 요청 시 GATEWAY 서버에서 회원의 Access Token을 검증
- Access Token이 유효하지 않으면 Refresh Token이 유효한지 확인하고 유효하면 토큰 재발급
- Access Token이 유효하면 BACK 서버에 API 요청
- BACK 서버에서 @MEMBER, @ADMIN 어노테이션을 통해 인가 처리

### 회원/관리자 페이지
- 회원 메인 마이페이지 진행 중 주문 건수, 쿠폰 보유 개수, 포인트 보유량, 회원 등급 및 최근 주문/배송 내역 구현
- 회원 개인 정보 수정 / 조회 / 삭제 기능 구현
- 회원 배송지 관리 생성 / 수정 / 조회 / 삭제 기능 구현
- 회원 등급 수정 / 조회 기능 구현
- 관리자 페이지 하루 방문자 수, 총 회원 수, 총 주문 수, 하루 매출, 이번 달 매출, 총 매출 및 일자별 요약 화면 구현
- 관리자 회원 목록 조회 / 회원 상태 변경 / 회원 권한 변경 / 회원 탈퇴 기능 구현


## 김용경
### 장바구니
- 회원, 페이코, 게스트 장바구니 담기, 수량 변경, 항목 삭제, 전체 삭제
- Redis 세션 클러스터링을 활용해 사용자별 장바구니 항목 개수를 안정적으로 분산 저장 및 유지 및 뷰 헤더의 장바구니 항목 개수를 동적으로 최신화하여 표현
- 로그인시 게스트에 담았던 장바구니 항목을 회원 장바구니에 병합
- 바로구매 또는 장바구니에서 선택한 항목을 구매시 쿠키에 담아서 주문서에 연결
- 주문 완료한 경우 해당 상품을 장바구니에 담겨있을 경우 수량 조절 및 삭제
- 해당 쿠키의 토스 결제 및 페이코 로그인에서의 리다이렉트 유지성 문제를 인터셉터를 적용하여 해결
- 리펙토링
    - 기존 회원 장바구니는 DB를 통해 관리했으나, 게스트와 회원 모두의 장바구니 데이터를 Redis로 통합 관리하여 조회 및 처리 성능을 향상
    - Redis의 휘발성 문제를 해결하기 위해, 일정 주기마다 스케줄러를 통해 회원의 장바구니 데이터를 DB에 동기화하여 데이터의 지속성을 확보

### 리뷰
- 상품 상세 페이지 및 주문 내역을 통해 구매한 상품에 대해 리뷰 작성 및 수정 기능
- 각 별점(1~5점) 리뷰 개수 및 평균 평점을 집계하여 표현
- 상품 페이징 목록에서 해당 상품에 대한 리뷰 전체 평점 및 개수 표현
- 회원이 작성한 리뷰 내역을 별도로 확인 및 관리할 수 있는 리뷰 내역

### 좋아요
- 상품 상세/목록 페이지에서 좋아요 추가 및 취소 기능
- 회원별 좋아요 상품 목록을 페이징 처리하여 제공
- 상품 목록에서 각 상품별 좋아요 수 및 회원의 좋아요 여부에 따라 버튼 UI 동적 반영

### MINIO
- 이미지 파일 업로드, 삭제, 조회 등 기능을 AWS S3 API 기반으로 통합 구현
- MinIO 관련 파일 처리 및 URL 가공 로직을 MinioUtils 클래스로 모듈화하여 재사용성 확보
- Nginx 리버스 프록시를 활용하여 HTTPS 자동 변환 문제 해결
- 리펙토링
    - 배포 환경의 리버스 프록시로 인해 배포/개발 환경 간 MinIO 접근 URL 차이를 고려하여 프로필에 따른 Util 클래스를 등록하여 적용
        
### 역할
- 엔티티 및 샘플 sql 작성
    - 설계한 ERD를 기반으로 연관 관계 매핑 및 제약 조건을 명확히 적용하여 모든 도메인의 엔티티 생성
    - 개발 초기 단계 테스트 용이성 확보를 위해 각 도메인별 연관 데이터를 고려하여 샘플 데이터를 작성하고 애플리케이션 부트 시 자동 실행되도록 구성
- 회의 기록
    - 팀 회의 시 논의 및 결정된 내용을 Notion을 활용해 체계적으로 정리
    - 기억 왜곡, 커뮤니케이션 누락을 방지하고 협업 효율을 높이기 위해 회의 직후 실시간 기록
- DB 매니저
    - 각 팀원이 요청한 필드 추가, 자료형 변경, 제약 조건 등을 검토하고 ERD/DDL을 통합된 구조로 관리
    - 변경 시 변경된 사유와 함께 기록하여 형상 일관성 유지

## 김현규
### 태그
- 관리자 페이지 저자 등록, 수정, 조회, 삭제
- 페이지네이션

### 상품(도서)
- 관리자 페이지 도서 등록, 수정, 조회, 삭제(Soft Delete)
- 도서 등록 시 ToastUI WYSIWYG 적용
- 도서 판매, 절판, 매진, 삭제 상태 구현 및 조회
- 도서 리스트 조회
- 도서 상세 조회
- 연관 도서 조회

### front layout 구조 설게
- page별 HTML layout 설계

## 박상준
### 포인트
1. 포인트 적립
- 회원가입, 리뷰작성, 도서구매시 정책의 적립률에 따라 적립
- 반품이나 환불시 주문에서 사용한 포인트 자동 반환, 적립된 포인트 자동 회수

2. 포인트 결제
- 포인트를 사용하여 결제 금액 차감 가능

3. 관리자 기능
- 관리자가 포인트 정책(규정) 생성 / 수정 / 조회 / 삭제 가능

4. 포인트 사용 이력
- 마이페이지에서 포인트 적립 및 사용 내역 확인 가능

5. 포인트 적립/회수/반환 등 핵심 로직을 비동기 분리 처리
- Spring 이벤트 리스너(EventListener) 적용

### 쿠폰
쿠폰 유형
- 관리자 발급 쿠폰
- 생일 쿠폰
- 웰컴 쿠폰

쿠폰 조회
- 회원은 쿠폰함에서 쿠폰 목록 확인 가능

메시지 큐 (RabbitMQ)
- RabbitMQ를 적용하여 발급 요청을 비동기 처리하고 시스템 부하 최소화

### 스케줄러 / 배치 처리
자동화 작업 목록
1. 회원 등급 자동 변경
- 3개월 동안의 순수 결제 금액 기준으로 자동 등급 조정
2. 미결제 주문 자동 삭제
- 10분 이상 미결제 주문 자동 삭제 처리
3. 생일 쿠폰 자동 발급
- 회원 생일에 맞춰 자동 쿠폰 발급
4. 배송 상태 자동 변경
- 상태가 '배송중'으로 1일 이상 경과 시, '배송완료'로 자동 전환


## 박수인


## 이영채
### 포장지
- 관리자가 포장지 등록, 조회, 수정(판매 여부 설정)
  - 포장지 이미지 업로드 지원
  - 목록 조회 시 페이지네이션 적용
- 사용자의 주문 페이지에서 판매 중인 포장지 리스트 조회

### 출판사
- 관리자가 출판사 등록, 조회, 수정
  - 목록 조회 시 페이지네이션 적용

### 카테고리
1. 카테고리 관리 기능
  - 관리자가 카테고리 등록, 조회, 수정(카테고리명), 삭제
  - N단계까지 확장 가능한 계층형 트리 구조로 카테고리 조회 구현
  - 삭제는 최하위 카테고리만 허용, 최소 2단계 이상의 계층 요구사항을 만족하도록 설계

2. 성능 최적화
  - 카테고리 데이터를 Redis에 캐싱하여 조회 성능 개선

### 상품(도서) - 보조 개발자로 참여
- 관리자가 도서 등록, 조회, 수정
- 도서 리스트 조회 기능
	- 목록 조회 시 페이지네이션 적용
- 도서 상세 페이지 조회 기능

### 검색
1. 검색 인프라 및 분석기 설정
  - Elasticsearch 인덱스 생성 및 매핑 설계
  - Nori 및 ICU 플러그인을 활용한 언어 분석기 구성
  - Kibana를 활용한 인덱스 및 문서 탐색

2. 검색 기능 고도화
  - 필드별 가중치 설정을 통한 통합 검색 정확도 향상
  - 동의어·유의어 사전을 활용한 의미 기반 유사 검색 지원
  - 대소문자 구분을 고려한 다국어 텍스트 정규화 처리

3. 정렬 기능
  - 인기도순(조회수, 검색수), 최신순(출판일자), 가격순(오름차순, 내림차순), 평점순, 리뷰순

4. 도서 목록 조회
  - 카테고리별 도서 리스트 조회
  - 조회수 및 검색어 트렌드를 반영한 실시간 베스트 도서 추천
  - 기준일(당일)을 기반으로 출판일자 3개월 이내의 신간 도서 조회


## 최종성
### 인프라
- NGINX 리버스 프록시 설정
- GitHub Actions 기반 CI/CD 파이프라인 구축
- 무중단 배포 환경 구성(서버 이중화)
- Spring LoadBalancer을 사용한 프론트-게이트웨이 간의 로드밸런싱 구현
  
### 주문
- 주문 요청 상품을 사용자가 보기 쉬운 형태의 주문서 페이지로 제공
- 회원의 경우 주문서 페이지 내에서 쿠폰 적용, 포인트 적용, 등록한 배송지 자동 적용 로직 구현
- 비회원/회원의 주문 내역 조회 및 관리자의 전체 주문에 대한 관리 페이지 제공
- 관리자의 주문 배송 시작 요청
- 배송 시작 전 상품에 대한 회원의 주문 취소 처리 로직 구현
  - 외부 결제 API의 결제 취소 요청 처리, 포인트 환불, 적립금 회수, 쿠폰 복구, 재고 복구 진행
- 배송 완료 상품에 대해 일정 기간내에서 회원의 반품 요청 처리 구현
  - 반품 사유에 따른 포인트 환불, 적립금 회수 진행

### 결제
- 외부 결제 API 사용 시 결제 완료 후 리다이렉션 시 주문 데이터를 유지하기 위해 재고 선 차감 및 DB에 저장
- 결제 승인 성공 시 포인트 차감, 적립, 쿠폰 사용 처리, 결제 내역 저장
- 결제 진행 중 실패 시 적용된 내용에 대한 롤백 처리
- 토스페이먼츠 API를 사용한 결제 서비스 지원
- 전략 패턴, 레지스트리 패턴을 활용하여 확장성을 고려한 결제 서비스 구현

  
### 배송비
- 관리자의 배송비 정책 관리, 조회 및 추가 기능 구현
- 주문 시 해당 시점에 활성화된 배송비 정책을 적용
  
## 팀원 공통 (수정)
- 요구 사항에 따른 데이터베이스 설계 및 ERD Diagram 작성
- Swagger를 사용해 API 정리
- Test 코드 및 SonarQube를 통해 코드 검증

